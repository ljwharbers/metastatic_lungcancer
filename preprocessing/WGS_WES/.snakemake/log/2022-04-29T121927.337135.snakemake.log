Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	2	aflred_post
	1	all
	2	bwa_map_se
	2	deduplication
	1	qc
	8
Select jobs to execute...

[Fri Apr 29 12:19:27 2022]
rule bwa_map_se:
    input: /mnt/AchTeraD/Documents/references/mm10/mm10.fa, /mnt/sequencing/BICRO322/fastq/CD15-mESC_S1_R1.fastq.gz
    output: /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam, /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam.bai
    jobid: 4
    wildcards: sample=CD15-mESC_S1
    threads: 38

bwa mem -M -t 38 -R '@RG\tID:CD15-mESC_S1\tSM:CD15-mESC_S1\tPL:ILLUMINA' /mnt/AchTeraD/Documents/references/mm10/mm10.fa /mnt/sequencing/BICRO322/fastq/CD15-mESC_S1_R1.fastq.gz | samtools sort -o /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam && samtools index -@ 38 /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam
Removing temporary output file /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam.bai.
[Fri Apr 29 12:59:42 2022]
Finished job 4.
1 of 8 steps (12%) done
Select jobs to execute...

[Fri Apr 29 12:59:42 2022]
rule bwa_map_se:
    input: /mnt/AchTeraD/Documents/references/mm10/mm10.fa, /mnt/sequencing/BICRO322/fastq/CD16-mOPC_S1_R1.fastq.gz
    output: /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam, /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam.bai
    jobid: 2
    wildcards: sample=CD16-mOPC_S1
    threads: 38

bwa mem -M -t 38 -R '@RG\tID:CD16-mOPC_S1\tSM:CD16-mOPC_S1\tPL:ILLUMINA' /mnt/AchTeraD/Documents/references/mm10/mm10.fa /mnt/sequencing/BICRO322/fastq/CD16-mOPC_S1_R1.fastq.gz | samtools sort -o /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam && samtools index -@ 38 /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam
Removing temporary output file /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam.bai.
[Fri Apr 29 13:29:50 2022]
Finished job 2.
2 of 8 steps (25%) done
Select jobs to execute...

[Fri Apr 29 13:29:50 2022]
rule deduplication:
    input: /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam
    output: /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam, /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.metrics.txt
    jobid: 1
    wildcards: sample=CD16-mOPC_S1
    threads: 4

gatk MarkDuplicates -I /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam -O /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam -M /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.metrics.txt

[Fri Apr 29 13:29:50 2022]
rule deduplication:
    input: /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam
    output: /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam, /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.metrics.txt
    jobid: 3
    wildcards: sample=CD15-mESC_S1
    threads: 4

gatk MarkDuplicates -I /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam -O /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam -M /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.metrics.txt
Write-protecting output file /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam.
Removing temporary output file /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam.
[Fri Apr 29 13:43:25 2022]
Finished job 1.
3 of 8 steps (38%) done
Select jobs to execute...

[Fri Apr 29 13:43:26 2022]
rule aflred_post:
    input: /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam, /mnt/AchTeraD/Documents/references/mm10/mm10.fa
    output: /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.dedup.tsv.gz
    jobid: 6
    wildcards: sample=CD16-mOPC_S1

/home/luukharbers/alfred/bin/alfred qc -r /mnt/AchTeraD/Documents/references/mm10/mm10.fa -o /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.dedup.tsv.gz /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam
Write-protecting output file /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam.
Removing temporary output file /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam.
[Fri Apr 29 13:46:13 2022]
Finished job 3.
4 of 8 steps (50%) done
Select jobs to execute...

[Fri Apr 29 13:46:13 2022]
rule aflred_post:
    input: /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam, /mnt/AchTeraD/Documents/references/mm10/mm10.fa
    output: /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.dedup.tsv.gz
    jobid: 7
    wildcards: sample=CD15-mESC_S1

/home/luukharbers/alfred/bin/alfred qc -r /mnt/AchTeraD/Documents/references/mm10/mm10.fa -o /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.dedup.tsv.gz /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam
[Fri Apr 29 13:52:44 2022]
Finished job 6.
5 of 8 steps (62%) done
[Fri Apr 29 13:55:57 2022]
Finished job 7.
6 of 8 steps (75%) done
Select jobs to execute...

[Fri Apr 29 13:55:57 2022]
rule qc:
    input: /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.dedup.tsv.gz, /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.dedup.tsv.gz
    output: /mnt/sequencing/BICRO322/stats/stats.tsv
    jobid: 5


        zgrep ^ME /mnt/sequencing/BICRO322/stats/*dedup.tsv.gz | cut -f 2- | \
        sed -n '1p;0~2p' > /mnt/sequencing/BICRO322/stats/stats.tsv
        
[Fri Apr 29 13:55:57 2022]
Finished job 5.
7 of 8 steps (88%) done
Select jobs to execute...

[Fri Apr 29 13:55:57 2022]
localrule all:
    input: /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam, /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam, /mnt/sequencing/BICRO322/stats/stats.tsv
    jobid: 0

[Fri Apr 29 13:55:57 2022]
Finished job 0.
8 of 8 steps (100%) done
Complete log: /mnt/AchTeraD/Documents/Projects/LungCancer/manuscript/repository/preprocessing/WGS_WES/.snakemake/log/2022-04-29T121927.337135.snakemake.log
