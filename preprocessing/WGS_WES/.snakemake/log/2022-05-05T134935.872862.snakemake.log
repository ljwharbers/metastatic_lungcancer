Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	2	aflred_post
	1	all
	2	bwa_map_se
	2	deduplication
	1	qc
	8
Select jobs to execute...

[Thu May  5 13:49:35 2022]
rule bwa_map_se:
    input: /mnt/AchTeraD/Documents/references/mm10/mm10.fa, /mnt/sequencing/BICRO322/fastq/CD15-mESC_S1_R1.fastq.gz
    output: /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam, /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam.bai
    jobid: 4
    wildcards: sample=CD15-mESC_S1
    threads: 38

bwa mem -M -t 38 -R '@RG\tID:CD15-mESC_S1\tSM:CD15-mESC_S1\tPL:ILLUMINA' /mnt/AchTeraD/Documents/references/mm10/mm10.fa /mnt/sequencing/BICRO322/fastq/CD15-mESC_S1_R1.fastq.gz | samtools sort -o /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam && samtools index -@ 38 /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam
Removing temporary output file /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam.bai.
[Thu May  5 14:37:45 2022]
Finished job 4.
1 of 8 steps (12%) done
Select jobs to execute...

[Thu May  5 14:37:45 2022]
rule bwa_map_se:
    input: /mnt/AchTeraD/Documents/references/mm10/mm10.fa, /mnt/sequencing/BICRO322/fastq/CD16-mOPC_S1_R1.fastq.gz
    output: /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam, /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam.bai
    jobid: 2
    wildcards: sample=CD16-mOPC_S1
    threads: 38

bwa mem -M -t 38 -R '@RG\tID:CD16-mOPC_S1\tSM:CD16-mOPC_S1\tPL:ILLUMINA' /mnt/AchTeraD/Documents/references/mm10/mm10.fa /mnt/sequencing/BICRO322/fastq/CD16-mOPC_S1_R1.fastq.gz | samtools sort -o /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam && samtools index -@ 38 /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam
Removing temporary output file /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam.bai.
[Thu May  5 15:08:07 2022]
Finished job 2.
2 of 8 steps (25%) done
Select jobs to execute...

[Thu May  5 15:08:07 2022]
rule deduplication:
    input: /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam
    output: /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam, /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.metrics.txt
    jobid: 1
    wildcards: sample=CD16-mOPC_S1
    threads: 4

gatk MarkDuplicates -I /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam -O /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam -M /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.metrics.txt

[Thu May  5 15:08:07 2022]
rule deduplication:
    input: /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam
    output: /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam, /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.metrics.txt
    jobid: 3
    wildcards: sample=CD15-mESC_S1
    threads: 4

gatk MarkDuplicates -I /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam -O /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam -M /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.metrics.txt
Write-protecting output file /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam.
Removing temporary output file /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.bam.
[Thu May  5 15:20:39 2022]
Finished job 1.
3 of 8 steps (38%) done
Select jobs to execute...

[Thu May  5 15:20:39 2022]
rule aflred_post:
    input: /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam, /mnt/AchTeraD/Documents/references/mm10/mm10.fa
    output: /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.dedup.tsv.gz
    jobid: 6
    wildcards: sample=CD16-mOPC_S1

/home/luukharbers/alfred/bin/alfred qc -r /mnt/AchTeraD/Documents/references/mm10/mm10.fa -o /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.dedup.tsv.gz /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam
[Thu May  5 15:20:39 2022]
Error in rule aflred_post:
    jobid: 6
    output: /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.dedup.tsv.gz
    shell:
        /home/luukharbers/alfred/bin/alfred qc -r /mnt/AchTeraD/Documents/references/mm10/mm10.fa -o /mnt/sequencing/BICRO322/stats/CD16-mOPC_S1.dedup.tsv.gz /mnt/sequencing/BICRO322/bamfiles/CD16-mOPC_S1.dedup.bam
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Job failed, going on with independent jobs.
Write-protecting output file /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam.
Removing temporary output file /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.bam.
[Thu May  5 15:21:46 2022]
Finished job 3.
4 of 8 steps (50%) done
Select jobs to execute...

[Thu May  5 15:21:46 2022]
rule aflred_post:
    input: /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam, /mnt/AchTeraD/Documents/references/mm10/mm10.fa
    output: /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.dedup.tsv.gz
    jobid: 7
    wildcards: sample=CD15-mESC_S1

/home/luukharbers/alfred/bin/alfred qc -r /mnt/AchTeraD/Documents/references/mm10/mm10.fa -o /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.dedup.tsv.gz /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam
[Thu May  5 15:21:46 2022]
Error in rule aflred_post:
    jobid: 7
    output: /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.dedup.tsv.gz
    shell:
        /home/luukharbers/alfred/bin/alfred qc -r /mnt/AchTeraD/Documents/references/mm10/mm10.fa -o /mnt/sequencing/BICRO322/stats/CD15-mESC_S1.dedup.tsv.gz /mnt/sequencing/BICRO322/bamfiles/CD15-mESC_S1.dedup.bam
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Job failed, going on with independent jobs.
Exiting because a job execution failed. Look above for error message
Complete log: /mnt/AchTeraD/Documents/Projects/LungCancer/manuscript/repository/preprocessing/WGS_WES/.snakemake/log/2022-05-05T134935.872862.snakemake.log
